<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>í”„ë¡œì íŠ¸ ë°œí‘œ</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .slide-container { 
            width: 1280px; 
            height: 720px; 
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 60px;
            display: flex;
            flex-direction: column;
        }
        .info-box {
            background: white;
            border-radius: 1rem;
            padding: 20px 30px;
            width: fit-content;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            border-left: 4px solid #3b82f6;
        }
        .code-box {
            background: white;
            border-radius: 1rem;
            padding: 30px;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            border-left: 4px solid #10b981;
        }
        .code-content {
            display: grid;
            grid-template-columns: 1.3fr 0.7fr; /* ì½”ë“œê°€ ê¸¸ì–´ì„œ ë¹„ìœ¨ ì¡°ì • */
            gap: 20px;
            flex: 1;
            overflow: hidden;
        }
        .code-section {
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 12px;
        }
        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 12px;
            overflow: auto;
            flex: 1;
            font-family: 'Courier New', monospace;
            font-size: 12px; /* ì½”ë“œ ì–‘ì´ ë§ì•„ í°íŠ¸ ì‚¬ì´ì¦ˆ ë¯¸ì„¸ ì¡°ì • */
            line-height: 1.5;
        }
        .explanation-box {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            overflow: auto;
            flex: 1;
            border: 1px solid #e2e8f0;
        }
        .explanation-item {
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid #e2e8f0;
        }
        .explanation-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .explanation-title {
            font-size: 15px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 6px;
        }
        .explanation-text {
            font-size: 14px;
            color: #6b7280;
            line-height: 1.5;
        }
        .info-title {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 5px;
        }
        .info-subtitle {
            font-size: 16px;
            font-weight: 500;
            color: #6b7280;
        }
        .code-title {
            font-size: 22px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 20px;
        }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
    </style>
</head>
<body>
<div class="slide-container">
    <div class="info-box">
        <div class="info-title">ê´€ì‹¬ì‚¬(Interest) ê´€ë¦¬</div>
        <div class="info-subtitle">ìˆ˜ì •(Update) ë° ì‚­ì œ(Delete) íŠ¸ëœì­ì…˜ ì²˜ë¦¬</div>
    </div>
    <div class="code-box">
        <div class="code-title">Service Layer êµ¬í˜„</div>
        <div class="code-content">
            <div class="code-section">
                <div class="section-title">ğŸ’» Java Source Code</div>
<pre>
<span style="color: #f472b6">@Transactional</span>
<span style="color: #f472b6">@Override</span>
<span style="color: #c084fc">public</span> <span style="color: #fbbf24">InterestDto</span> <span style="color: #60a5fa">interestUpdate</span>(<span style="color: #fbbf24">UUID</span> interest, <span style="color: #fbbf24">InterestUpdateRequest</span> request) {
    <span style="color: #fbbf24">Interest</span> interestUpdate = interestRepository.<span style="color: #60a5fa">findById</span>(interest)
            .<span style="color: #60a5fa">orElseThrow</span>(<span style="color: #fbbf24">InterestsNotFoundException</span>::<span style="color: #c084fc">new</span>);
    <span style="color: #6b7280">// ë„ë©”ì¸ ë©”ì„œë“œë¥¼ í†µí•œ ìƒíƒœ ë³€ê²½ (Setter ì§€ì–‘)</span>
    interestUpdate.<span style="color: #60a5fa">keywordUpdate</span>(request.<span style="color: #60a5fa">keywords</span>());
    interestRepository.<span style="color: #60a5fa">save</span>(interestUpdate);
    <span style="color: #c084fc">return</span> interestMapper.<span style="color: #60a5fa">toDto</span>(interestUpdate, <span style="color: #c084fc">null</span>);
}
<span style="color: #c084fc">public void</span> <span style="color: #60a5fa">interestDelete</span>(<span style="color: #fbbf24">UUID</span> interest) {
<span style="color: #fbbf24">Interest</span> interestDelete = interestRepository.<span style="color: #60a5fa">findById</span>(interest)
.<span style="color: #60a5fa">orElseThrow</span>(<span style="color: #fbbf24">InterestsNotFoundException</span>::<span style="color: #c084fc">new</span>);
    <span style="color: #6b7280">// 1. ì°¸ì¡° ë¬´ê²°ì„± ê²€ì‚¬: ë‰´ìŠ¤ê°€ ì°¸ì¡° ì¤‘ì´ë©´ ì‚­ì œ ë¶ˆê°€</span>
    <span style="color: #c084fc">if</span> (articleRepository.<span style="color: #60a5fa">existsByInterestId</span>(interest)) {
        <span style="color: #c084fc">throw new</span> <span style="color: #fbbf24">IllegalStateException</span>(<span style="color: #a78bfa">"í•´ë‹¹ ê´€ì‹¬ì‚¬ë¥¼ ì°¸ì¡°í•˜ëŠ” ë‰´ìŠ¤ê°€ ì¡´ì¬..."</span>);
    }
    <span style="color: #6b7280">// 2. ì—°ê´€ ë°ì´í„°(êµ¬ë…) ì¼ê´„ ì¡°íšŒ ë° ì‚­ì œ</span>
    <span style="color: #fbbf24">List</span>&lt;<span style="color: #fbbf24">Subscribe</span>&gt; subscribeList = subscribeRepository
            .<span style="color: #60a5fa">findByInterestIdIn</span>(<span style="color: #fbbf24">List</span>.<span style="color: #60a5fa">of</span>(interest));
    subscribeRepository.<span style="color: #60a5fa">deleteAll</span>(subscribeList);
    <span style="color: #6b7280">// 3. ìµœì¢… Interest ì‚­ì œ</span>
    interestRepository.<span style="color: #60a5fa">delete</span>(interestDelete);
}</pre>
</div>
            <div class="code-section">
                <div class="section-title">ğŸ“ ë¡œì§ ìƒì„¸ ë¶„ì„</div>
                <div class="explanation-box">
                    <div class="explanation-item">
                        <div class="explanation-title">[Update] ë„ë©”ì¸ ì£¼ë„ ì„¤ê³„</div>
                        <div class="explanation-text">
                            ë‹¨ìˆœ Setter ì‚¬ìš©ì„ ì§€ì–‘í•˜ê³ , <code>keywordUpdate()</code>ë¼ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ë¯¸ê°€ ë‹´ê¸´ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ê°ì²´ì˜ ìƒíƒœë¥¼ ì•ˆì „í•˜ê²Œ ë³€ê²½í•©ë‹ˆë‹¤.
                        </div>
                    </div>
                    <div class="explanation-item">
                        <div class="explanation-title">[Delete] ì°¸ì¡° ë¬´ê²°ì„± ê²€ì¦</div>
                        <div class="explanation-text">
                            ê´€ì‹¬ì‚¬ë¥¼ ì‚­ì œí•˜ê¸° ì „, í•´ë‹¹ ê´€ì‹¬ì‚¬ë¥¼ ì‚¬ìš© ì¤‘ì¸ ë‰´ìŠ¤(Article)ê°€ ìˆëŠ”ì§€ <code>existsByInterestId</code>ë¡œ í™•ì¸í•©ë‹ˆë‹¤. ë°ì´í„° ê³ ì•„ ê°ì²´(Orphan) ë°œìƒì„ ë°©ì§€í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.
                        </div>
                    </div>
                    <div class="explanation-item">
                        <div class="explanation-title">[Delete] ì—°ê´€ ë°ì´í„° ì‚­ì œ</div>
                        <div class="explanation-text">
                            ê´€ì‹¬ì‚¬ê°€ ì‚­ì œë  ë•Œ ì´ë¥¼ êµ¬ë…(Subscribe)í•œ ì •ë³´ë“¤ë„ í•¨ê»˜ ì§€ì›Œì ¸ì•¼ í•©ë‹ˆë‹¤. N+1 ë¬¸ì œë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ë¦¬ìŠ¤íŠ¸ë¡œ ì¡°íšŒ í›„ <code>deleteAll</code>ë¡œ ì¼ê´„ ì‚­ì œí•©ë‹ˆë‹¤.
                        </div>
                    </div>
                    <div class="explanation-item">
                        <div class="explanation-title">ì˜ˆì™¸ ì²˜ë¦¬ ì „ëµ</div>
                        <div class="explanation-text">
                            ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ID ì¡°íšŒ ì‹œ <code>InterestsNotFoundException</code>(404), ì‚­ì œ ë¶ˆê°€ëŠ¥ ìƒíƒœì¼ ë•Œ <code>IllegalStateException</code>(400/409)ì„ ë°œìƒì‹œì¼œ ëª…í™•í•œ ì—ëŸ¬ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>