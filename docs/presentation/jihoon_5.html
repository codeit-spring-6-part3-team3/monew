<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>í”„ë¡œì íŠ¸ ë°œí‘œ</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .slide-container { 
            width: 1280px; 
            height: 720px; 
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 60px;
            display: flex;
            flex-direction: column;
        }
        .info-box {
            background: white;
            border-radius: 1rem;
            padding: 20px 30px;
            width: fit-content;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            border-left: 4px solid #3b82f6;
        }
        .code-box {
            background: white;
            border-radius: 1rem;
            padding: 30px;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            border-left: 4px solid #10b981;
        }
        .code-content {
            display: grid;
            grid-template-columns: 1.3fr 0.7fr; /* ì½”ë“œ ì˜ì—­ ë¹„ìœ¨ í™•ëŒ€ */
            gap: 20px;
            flex: 1;
            overflow: hidden;
        }
        .code-section {
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 12px;
        }
        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 12px;
            overflow: auto;
            flex: 1;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.5;
        }
        .explanation-box {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            overflow: auto;
            flex: 1;
            border: 1px solid #e2e8f0;
        }
        .explanation-item {
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid #e2e8f0;
        }
        .explanation-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .explanation-title {
            font-size: 15px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 6px;
        }
        .explanation-text {
            font-size: 14px;
            color: #6b7280;
            line-height: 1.5;
        }
        .info-title {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 5px;
        }
        .info-subtitle {
            font-size: 16px;
            font-weight: 500;
            color: #6b7280;
        }
        .code-title {
            font-size: 22px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 20px;
        }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
    </style>
</head>
<body>
<div class="slide-container">
    <div class="info-box">
        <div class="info-title">êµ¬ë… ê¸°ëŠ¥</div>
        <div class="info-subtitle">êµ¬ë… ìƒì„± ë° ì·¨ì†Œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§</div>
    </div>
    <div class="code-box">
        <div class="code-title">Service Layer êµ¬í˜„ë¶€</div>
        <div class="code-content">
            <div class="code-section">
                <div class="section-title">ğŸ’» Java Source Code</div>
<pre>
<span style="color: #6b7280">// 1. êµ¬ë… ìƒì„±</span>
<span style="color: #f472b6">@Transactional</span>
<span style="color: #f472b6">@Override</span>
<span style="color: #c084fc">public</span> <span style="color: #fbbf24">SubscribeDto</span> <span style="color: #60a5fa">subscribeCreate</span>(<span style="color: #fbbf24">UUID</span> userId, <span style="color: #fbbf24">UUID</span> interestId) {
    userRepository.<span style="color: #60a5fa">findById</span>(userId)
            .<span style="color: #60a5fa">orElseThrow</span>(<span style="color: #fbbf24">UserNotFoundException</span>::<span style="color: #c084fc">new</span>);
    <span style="color: #fbbf24">Interest</span> interest = interestRepository.<span style="color: #60a5fa">findById</span>(interestId)
            .<span style="color: #60a5fa">orElseThrow</span>(<span style="color: #fbbf24">InterestsNotFoundException</span>::<span style="color: #c084fc">new</span>);
    <span style="color: #fbbf24">Subscribe</span> subscribe = <span style="color: #fbbf24">Subscribe</span>.<span style="color: #60a5fa">builder</span>()
            .<span style="color: #60a5fa">userId</span>(userId)
            .<span style="color: #60a5fa">interestId</span>(interestId)
            .<span style="color: #60a5fa">build</span>();
    interest.<span style="color: #60a5fa">subscribeAdd</span>(); <span style="color: #6b7280">// ê´€ì‹¬ì‚¬ êµ¬ë… ì¹´ìš´íŠ¸ ì¦ê°€ (+)</span>
    subscribeRepository.<span style="color: #60a5fa">save</span>(subscribe);
    interestRepository.<span style="color: #60a5fa">save</span>(interest);
    <span style="color: #c084fc">return</span> subscribeMapper.<span style="color: #60a5fa">toDto</span>(subscribe, interest);
}
<span style="color: #6b7280">// 2. êµ¬ë… ì·¨ì†Œ (Delete)</span>
<span style="color: #f472b6">@Override</span>
<span style="color: #c084fc">public void</span> <span style="color: #60a5fa">subscribeDelete</span>(<span style="color: #fbbf24">UUID</span> userId, <span style="color: #fbbf24">UUID</span> interestId) {
userRepository.<span style="color: #60a5fa">findById</span>(userId)
.<span style="color: #60a5fa">orElseThrow</span>(<span style="color: #fbbf24">UserNotFoundException</span>::<span style="color: #c084fc">new</span>);
    <span style="color: #fbbf24">Interest</span> interest = interestRepository.<span style="color: #60a5fa">findById</span>(interestId)
            .<span style="color: #60a5fa">orElseThrow</span>(<span style="color: #fbbf24">InterestsNotFoundException</span>::<span style="color: #c084fc">new</span>);
    <span style="color: #fbbf24">Subscribe</span> subscribe = subscribeRepository
            .<span style="color: #60a5fa">findByUserIdAndInterestId</span>(userId, interestId)
            .<span style="color: #60a5fa">orElse</span>(<span style="color: #c084fc">null</span>);
    <span style="color: #c084fc">if</span> (subscribe == <span style="color: #c084fc">null</span>) <span style="color: #c084fc">return</span>; <span style="color: #6b7280">// ì´ë¯¸ êµ¬ë… ì·¨ì†Œëœ ê²½ìš° ì˜ˆì™¸ ì—†ì´ ë¦¬í„´</span>
    interest.<span style="color: #60a5fa">subscribeRemove</span>(); <span style="color: #6b7280">// ê´€ì‹¬ì‚¬ êµ¬ë… ì¹´ìš´íŠ¸ ê°ì†Œ (-)</span>
    interestRepository.<span style="color: #60a5fa">save</span>(interest);
    subscribeRepository.<span style="color: #60a5fa">delete</span>(subscribe);
}</pre>
</div>
            <div class="code-section">
                <div class="section-title">ğŸ“ ë¡œì§ ìƒì„¸ ë¶„ì„</div>
                <div class="explanation-box">
                    <div class="explanation-item">
                        <div class="explanation-title">ë°ì´í„° ì •í•©ì„± ê²€ì¦ (Validation)</div>
                        <div class="explanation-text">
                            êµ¬ë…ì„ ìƒì„±/ì‚­ì œí•˜ê¸° ì „, <code>User</code>ì™€ <code>Interest</code>ê°€ ì‹¤ì œë¡œ DBì— ì¡´ì¬í•˜ëŠ”ì§€ ë¨¼ì € ê²€ì¦í•©ë‹ˆë‹¤. ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš° ëª…ì‹œì ì¸ ì˜ˆì™¸(NotFoundException)ë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤.
                        </div>
                    </div>
                    <div class="explanation-item">
                        <div class="explanation-title">ë„ë©”ì¸ ì£¼ë„ ì„¤ê³„ (DDD)</div>
                        <div class="explanation-text">
                            êµ¬ë…ì ìˆ˜ ë³€ê²½ ë¡œì§ì„ ì„œë¹„ìŠ¤ ë ˆì´ì–´ì— ë…¸ì¶œí•˜ì§€ ì•Šê³ , Entity ë‚´ë¶€ ë©”ì„œë“œì¸ <code>subscribeAdd()</code>, <code>subscribeRemove()</code>ë¥¼ í˜¸ì¶œí•˜ì—¬ ìº¡ìŠí™”ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.
                        </div>
                    </div>
                    <div class="explanation-item">
                        <div class="explanation-title">ë°ì´í„° ë™ê¸°í™” (Sync)</div>
                        <div class="explanation-text">
                            êµ¬ë… í…Œì´ë¸”(Subscribe)ì˜ í–‰ ì¶”ê°€/ì‚­ì œì™€ ë™ì‹œì—, ê´€ì‹¬ì‚¬ í…Œì´ë¸”(Interest)ì˜ <code>subscribeCount</code> ì»¬ëŸ¼ë„ ì—…ë°ì´íŠ¸í•˜ì—¬ ë°ì´í„°ì˜ ì¼ê´€ì„±ì„ ë³´ì¥í•©ë‹ˆë‹¤.
                        </div>
                    </div>
                    <div class="explanation-item">
                        <div class="explanation-title">ë©±ë“±ì„± ê³ ë ¤ (Idempotency)</div>
                        <div class="explanation-text">
                            ì‚­ì œ ìš”ì²­ ì‹œ ì´ë¯¸ êµ¬ë…ì´ ì·¨ì†Œëœ ìƒíƒœ(null)ë¼ë©´, ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¤ëŠ” ëŒ€ì‹  <code>return</code> ì²˜ë¦¬í•©ë‹ˆë‹¤. ì´ëŠ” ì¤‘ë³µ ì‚­ì œ ìš”ì²­ì—ë„ ì‹œìŠ¤í…œì´ ì•ˆì „í•˜ê²Œ ë™ì‘í•˜ë„ë¡ í•©ë‹ˆë‹¤.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>